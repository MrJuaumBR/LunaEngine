<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spritesheets - LunaEngine Examples</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="../theme.css" rel="stylesheet">
</head>
<body>
    
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="../index.html" id="navbar-logo-link">
                <i class="bi bi-moon-stars-fill me-2"></i>
                LunaEngine
            </a>
            <div class="d-flex align-items-center">
                <div class="input-group me-3">
                    <input type="text" id="moduleSearch" class="form-control" placeholder="Search functions, classes, methods...">
                    <span class="input-group-text" id="searchIcon"><i class="bi bi-search"></i></span>
                </div>
                
                <button class="btn btn-outline-secondary theme-toggle">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container mt-5">
        <nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../index.html">Home</a></li><li class="breadcrumb-item"><a href="index.html">Examples Hub</a></li><li class="breadcrumb-item active">Spritesheets</li></ol></nav>
        
        <div class="row">
            <div class="col-lg-8">
                <h1 class="mb-3"><i class="bi bi-code-slash me-2"></i>Spritesheets</h1>
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-file-earmark-code me-2"></i>spritesheets.py</h5>
                    </div>
                    <div class="card-body">
                        <pre><code class="language-python">&quot;&quot;&quot;
Sprite Sheets Example - Testing SpriteSheet and Animation System with LunaEngine
Now with Fade-in and Fade-out support!

LOCATION: examples/spritesheets.py

DESCRIPTION:
Simple test scene to demonstrate the sprite sheet and animation system
using the tiki_texture.png file. Now includes fade effects for smooth transitions.
&quot;&quot;&quot;

import sys
import os
sys.path.append(os.path.join(os.path.dirname(__file__), &#x27;..&#x27;))

from lunaengine.core import Scene, LunaEngine
from lunaengine.ui import *
from lunaengine.graphics.spritesheet import Animation
import pygame

class SpriteSheetTestScene(Scene):
    &quot;&quot;&quot;
    Test scene for sprite sheet and animation system with fade effects.
    
    Demonstrates how to use the Animation class with fade-in and fade-out
    within a LunaEngine scene.
    &quot;&quot;&quot;
    
    def __init__(self, engine: LunaEngine):
        super().__init__(engine)
        self.CurrentTheme = ThemeType.DEFAULT
        
        # Animation instances
        self.walk_animation = None
        self.idle_animation = None
        self.current_animation = None
        
        # Animation state
        self.animation_scale = 2.0
        self.animation_speed = 1.0
        self.current_animation_name = &quot;Walk&quot;
        
        # Fade effect settings
        self.fade_in_duration = 1.0
        self.fade_out_duration = 1.0
        self.auto_fade_transitions = True
        
        # Setup UI
        self.setup_ui()
        
        # Register key events
        @engine.on_event(pygame.KEYDOWN)
        def on_key_press(event):
            self.handle_key_press(event.key)
    
    def on_enter(self, previous_scene=None):
        &quot;&quot;&quot;
        Called when scene becomes active.
        
        Args:
            previous_scene: Name of the previous scene
        &quot;&quot;&quot;
        super().on_enter(previous_scene)
        print(&quot;Entered SpriteSheet Test Scene&quot;)
        
        # Load animations
        self.load_animations()
        
        # Reset animations when entering scene
        if self.current_animation:
            self.current_animation.reset()
            self.current_animation.play()
            
    
    def on_exit(self, next_scene=None):
        &quot;&quot;&quot;
        Called when scene is being exited.
        
        Args:
            next_scene: Name of the next scene
        &quot;&quot;&quot;
        super().on_exit(next_scene)
        print(&quot;Exiting SpriteSheet Test Scene&quot;)
    
    def load_animations(self):
        &quot;&quot;&quot;Load the tiki texture animations with fade support&quot;&quot;&quot;
        try:
            texture_path = &#x27;./examples/tiki_texture.png&#x27;
            
            # Walk animation - 6 frames starting at (0, 0)
            self.walk_animation = Animation(
                spritesheet_file=texture_path,
                size=(70, 70),
                start_pos=(0, 0),
                frame_count=6,
                scale=(self.animation_scale, self.animation_scale),
                duration=1.0 / self.animation_speed,
                loop=True,
                fade_in_duration=self.fade_in_duration,
                fade_out_duration=self.fade_out_duration
            )
            
            # Idle animation - 6 frames starting at (0, 70)
            self.idle_animation = Animation(
                spritesheet_file=texture_path,
                size=(70, 70),
                start_pos=(0, 70),
                frame_count=6,
                scale=(self.animation_scale, self.animation_scale),
                duration=1.5 / self.animation_speed,
                loop=True,
                fade_in_duration=self.fade_in_duration,
                fade_out_duration=self.fade_out_duration
            )
            
            # Set current animation
            self.current_animation = self.walk_animation
            self.current_animation_name = &quot;Walk&quot;
            
            print(&quot;Successfully loaded tiki texture animations with fade support!&quot;)
            print(f&quot;Walk animation: {self.walk_animation.get_frame_count()} frames&quot;)
            print(f&quot;Idle animation: {self.idle_animation.get_frame_count()} frames&quot;)
            
        except Exception as e:
            print(f&quot;Error loading animations: {e}&quot;)
            # Create placeholder animations if loading fails
            self.create_placeholder_animations()
    
    def reload_animations_with_new_settings(self):
        &quot;&quot;&quot;Reload animations with current scale, speed and fade settings&quot;&quot;&quot;
        if hasattr(self, &#x27;walk_animation&#x27;) and self.walk_animation:
            # Store current animation state
            was_walk = (self.current_animation == self.walk_animation)
            current_frame_index = self.current_animation.current_frame_index if self.current_animation else 0
            
            # Reload animations
            self.load_animations()
            
            # Restore animation state
            if was_walk:
                self.current_animation = self.walk_animation
            else:
                self.current_animation = self.idle_animation
            
            if self.current_animation:
                self.current_animation.current_frame_index = min(current_frame_index, self.current_animation.get_frame_count() - 1)
                self.current_animation.play()
    
    def create_placeholder_animations(self):
        &quot;&quot;&quot;Create placeholder animations if tiki texture is not available&quot;&quot;&quot;
        # Create simple colored squares as placeholders
        placeholder_frames = []
        colors = [(255, 0, 0), (0, 255, 0), (0, 0, 255), (255, 255, 0)]
        
        for color in colors:
            surface = pygame.Surface((70, 70), pygame.SRCALPHA)
            pygame.draw.rect(surface, color, (0, 0, 70, 70))
            pygame.draw.rect(surface, (255, 255, 255), (0, 0, 70, 70), 2)
            # Apply scaling to placeholder frames
            if self.animation_scale != 1.0:
                new_size = (int(70 * self.animation_scale), int(70 * self.animation_scale))
                surface = pygame.transform.scale(surface, new_size)
            placeholder_frames.append(surface)
        
        # Create simple animation object with fade support
        class PlaceholderAnimation:
            def __init__(self, frames, duration=1.0, fade_in_duration=0.0, fade_out_duration=0.0):
                self.frames = frames
                self.duration = duration
                self.frame_duration = duration / len(frames) if frames else 0
                self.current_frame_index = 0
                self.last_update_time = pygame.time.get_ticks() / 1000.0
                self.accumulated_time = 0.0
                self.playing = True
                self.loop = True
                
                # Fade effect properties
                self.fade_in_duration = fade_in_duration
                self.fade_out_duration = fade_out_duration
                self.fade_alpha = 0 if fade_in_duration &gt; 0 else 255
                self.fade_mode = &#x27;in&#x27; if fade_in_duration &gt; 0 else None
                self.fade_start_time = pygame.time.get_ticks() / 1000.0 if fade_in_duration &gt; 0 else None
                self.fade_progress = 0.0
            
            def _apply_fade_effect(self, surface):
                &quot;&quot;&quot;Apply current fade alpha to a surface&quot;&quot;&quot;
                if self.fade_alpha == 255:
                    return surface
                    
                faded_surface = surface.copy()
                temp_surface = pygame.Surface(faded_surface.get_size(), pygame.SRCALPHA)
                temp_surface.fill((255, 255, 255, self.fade_alpha))
                faded_surface.blit(temp_surface, (0, 0), special_flags=pygame.BLEND_RGBA_MULT)
                return faded_surface
            
            def update_fade(self):
                &quot;&quot;&quot;Update fade-in and fade-out effects&quot;&quot;&quot;
                current_time = pygame.time.get_ticks() / 1000.0
                
                if self.fade_mode == &#x27;in&#x27;:
                    if self.fade_start_time is None:
                        self.fade_start_time = current_time
                        return
                        
                    elapsed = current_time - self.fade_start_time
                    self.fade_progress = min(elapsed / self.fade_in_duration, 1.0)
                    self.fade_alpha = int(self.fade_progress * 255)
                    
                    if self.fade_progress &gt;= 1.0:
                        self.fade_alpha = 255
                        self.fade_mode = None
                        self.fade_start_time = None
                        
                elif self.fade_mode == &#x27;out&#x27;:
                    if self.fade_start_time is None:
                        self.fade_start_time = current_time
                        return
                        
                    elapsed = current_time - self.fade_start_time
                    self.fade_progress = min(elapsed / self.fade_out_duration, 1.0)
                    self.fade_alpha = int((1.0 - self.fade_progress) * 255)
                    
                    if self.fade_progress &gt;= 1.0:
                        self.fade_alpha = 0
                        self.fade_mode = None
                        self.fade_start_time = None
                        self.playing = False
            
            def update(self):
                &quot;&quot;&quot;Update animation with fade effects&quot;&quot;&quot;
                # Update fade effects first
                if self.fade_mode:
                    self.update_fade()
                
                if not self.playing or len(self.frames) &lt;= 1:
                    return
                
                current_time = pygame.time.get_ticks() / 1000.0
                delta_time = current_time - self.last_update_time
                self.last_update_time = current_time
                
                self.accumulated_time += delta_time
                frames_to_advance = int(self.accumulated_time / self.frame_duration)
                
                if frames_to_advance &gt; 0:
                    self.accumulated_time -= frames_to_advance * self.frame_duration
                    if self.loop:
                        self.current_frame_index = (self.current_frame_index + frames_to_advance) % len(self.frames)
                    else:
                        self.current_frame_index = min(self.current_frame_index + frames_to_advance, len(self.frames) - 1)
            
            def get_current_frame(self):
                &quot;&quot;&quot;Get current frame with fade effect applied&quot;&quot;&quot;
                if not self.frames:
                    blank = pygame.Surface((1, 1), pygame.SRCALPHA)
                    blank.fill((0, 0, 0, 0))
                    return blank
                
                frame = self.frames[self.current_frame_index]
                
                # Apply fade effect if needed
                if self.fade_mode or self.fade_alpha != 255:
                    return self._apply_fade_effect(frame)
                
                return frame
            
            def reset(self):
                &quot;&quot;&quot;Reset animation and fade effects&quot;&quot;&quot;
                self.current_frame_index = 0
                self.accumulated_time = 0.0
                self.last_update_time = pygame.time.get_ticks() / 1000.0
                self.playing = True
                
                # Reset fade effects
                if self.fade_in_duration &gt; 0:
                    self.fade_mode = &#x27;in&#x27;
                    self.fade_alpha = 0
                else:
                    self.fade_mode = None
                    self.fade_alpha = 255
                    
                self.fade_start_time = pygame.time.get_ticks() / 1000.0 if self.fade_mode else None
                self.fade_progress = 0.0
            
            def play(self):
                &quot;&quot;&quot;Start or resume animation&quot;&quot;&quot;
                self.playing = True
                self.last_update_time = pygame.time.get_ticks() / 1000.0
            
            def pause(self):
                &quot;&quot;&quot;Pause animation&quot;&quot;&quot;
                self.playing = False
            
            def get_frame_count(self):
                return len(self.frames)
            
            def set_duration(self, new_duration):
                self.duration = new_duration
                self.frame_duration = new_duration / len(self.frames) if self.frames else 0
            
            def start_fade_in(self, duration=None):
                &quot;&quot;&quot;Start fade-in effect&quot;&quot;&quot;
                if duration is not None:
                    self.fade_in_duration = duration
                    
                if self.fade_in_duration &gt; 0:
                    self.fade_mode = &#x27;in&#x27;
                    self.fade_alpha = 0
                    self.fade_start_time = pygame.time.get_ticks() / 1000.0
                    self.fade_progress = 0.0
                    self.playing = True
            
            def start_fade_out(self, duration=None):
                &quot;&quot;&quot;Start fade-out effect&quot;&quot;&quot;
                if duration is not None:
                    self.fade_out_duration = duration
                    
                if self.fade_out_duration &gt; 0:
                    self.fade_mode = &#x27;out&#x27;
                    self.fade_alpha = 255
                    self.fade_start_time = pygame.time.get_ticks() / 1000.0
                    self.fade_progress = 0.0
            
            def set_fade_alpha(self, alpha):
                &quot;&quot;&quot;Manually set fade alpha&quot;&quot;&quot;
                self.fade_alpha = max(0, min(255, alpha))
                self.fade_mode = None
            
            def is_fade_complete(self):
                &quot;&quot;&quot;Check if fade effect is complete&quot;&quot;&quot;
                return self.fade_mode is None
        
        self.walk_animation = PlaceholderAnimation(
            placeholder_frames, 
            1.0 / self.animation_speed,
            self.fade_in_duration,
            self.fade_out_duration
        )
        self.idle_animation = PlaceholderAnimation(
            placeholder_frames[::-1], 
            1.5 / self.animation_speed,
            self.fade_in_duration,
            self.fade_out_duration
        )
        self.current_animation = self.walk_animation
        self.current_animation_name = &quot;Walk (Placeholder)&quot;
        
        print(&quot;Using placeholder animations with fade support - tiki_texture.png not found!&quot;)
    
    def setup_ui(self):
        &quot;&quot;&quot;Setup user interface elements with fade controls&quot;&quot;&quot;
        
        # Title
        title = TextLabel(512, 30, &quot;Sprite Sheet System Test&quot;, 48, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(title)
        
        # Animation info
        self.info_label = TextLabel(512, 80, &quot;Press SPACE to switch animations&quot;, 24, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(self.info_label)
        
        # Current animation display
        self.anim_name_label = TextLabel(512, 110, f&quot;Current: {self.current_animation_name}&quot;, 32, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(self.anim_name_label)
        
        # Frame counter
        self.frame_label = TextLabel(512, 150, &quot;Frame: 1/6&quot;, 24, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(self.frame_label)
        
        # Speed control
        speed_label = TextLabel(200, 200, &quot;Animation Speed:&quot;, 24, root_point=(0, 0), theme=self.CurrentTheme)
        self.ui_elements.append(speed_label)
        
        self.speed_slider = Slider(200, 230, 200, 20, 0.1, 3.0, self.animation_speed, root_point=(0, 0), theme=self.CurrentTheme)
        self.speed_slider.on_value_changed = self.on_speed_changed
        self.ui_elements.append(self.speed_slider)
        
        self.speed_value_label = TextLabel(410, 230, f&quot;{self.animation_speed:.1f}x&quot;, 20, root_point=(0, 0.5), theme=self.CurrentTheme)
        self.ui_elements.append(self.speed_value_label)
        
        # Zoom control
        zoom_label = TextLabel(200, 270, &quot;Zoom Level:&quot;, 24, root_point=(0, 0), theme=self.CurrentTheme)
        self.ui_elements.append(zoom_label)
        
        self.zoom_slider = Slider(200, 300, 200, 20, 0.5, 4.0, self.animation_scale, root_point=(0, 0), theme=self.CurrentTheme)
        self.zoom_slider.on_value_changed = self.on_zoom_changed
        self.ui_elements.append(self.zoom_slider)
        
        self.zoom_value_label = TextLabel(410, 300, f&quot;{self.animation_scale:.1f}x&quot;, 20, root_point=(0, 0.5), theme=self.CurrentTheme)
        self.ui_elements.append(self.zoom_value_label)
        
        # Fade-in control
        fade_in_label = TextLabel(200, 340, &quot;Fade-in Duration:&quot;, 24, root_point=(0, 0), theme=self.CurrentTheme)
        self.ui_elements.append(fade_in_label)
        
        self.fade_in_slider = Slider(200, 370, 200, 20, 0.0, 3.0, self.fade_in_duration, root_point=(0, 0), theme=self.CurrentTheme)
        self.fade_in_slider.on_value_changed = self.on_fade_in_changed
        self.ui_elements.append(self.fade_in_slider)
        
        self.fade_in_value_label = TextLabel(410, 370, f&quot;{self.fade_in_duration:.1f}s&quot;, 20, root_point=(0, 0.5), theme=self.CurrentTheme)
        self.ui_elements.append(self.fade_in_value_label)
        
        # Fade-out control
        fade_out_label = TextLabel(200, 410, &quot;Fade-out Duration:&quot;, 24, root_point=(0, 0), theme=self.CurrentTheme)
        self.ui_elements.append(fade_out_label)
        
        self.fade_out_slider = Slider(200, 440, 200, 20, 0.0, 3.0, self.fade_out_duration, root_point=(0, 0), theme=self.CurrentTheme)
        self.fade_out_slider.on_value_changed = self.on_fade_out_changed
        self.ui_elements.append(self.fade_out_slider)
        
        self.fade_out_value_label = TextLabel(410, 440, f&quot;{self.fade_out_duration:.1f}s&quot;, 20, root_point=(0, 0.5), theme=self.CurrentTheme)
        self.ui_elements.append(self.fade_out_value_label)
        
        # Auto-fade toggle
        self.auto_fade_toggle = Switch(200, 490, 40, 20, self.auto_fade_transitions, root_point=(0, 0), theme=self.CurrentTheme)
        self.auto_fade_toggle.set_on_toggle(self.on_auto_fade_changed)
        self.ui_elements.append(self.auto_fade_toggle)
        
        auto_fade_label = TextLabel(230, 480, &quot;Auto fade on switch&quot;, 20, root_point=(0, 0.5), theme=self.CurrentTheme)
        self.ui_elements.append(auto_fade_label)
        
        # Control buttons
        play_btn = Button(200, 520, 80, 30, &quot;Play&quot;, 20, root_point=(0, 0), theme=self.CurrentTheme)
        play_btn.set_on_click(self.play_animation)
        self.ui_elements.append(play_btn)
        
        pause_btn = Button(290, 520, 80, 30, &quot;Pause&quot;, 20, root_point=(0, 0), theme=self.CurrentTheme)
        pause_btn.set_on_click(self.pause_animation)
        self.ui_elements.append(pause_btn)
        
        reset_btn = Button(380, 520, 80, 30, &quot;Reset&quot;, 20, root_point=(0, 0), theme=self.CurrentTheme)
        reset_btn.set_on_click(self.reset_animation)
        self.ui_elements.append(reset_btn)
        
        # Fade effect buttons
        fade_in_btn = Button(470, 520, 100, 30, &quot;Fade In&quot;, 18, root_point=(0, 0), theme=self.CurrentTheme)
        fade_in_btn.set_on_click(self.trigger_fade_in)
        self.ui_elements.append(fade_in_btn)
        
        fade_out_btn = Button(580, 520, 100, 30, &quot;Fade Out&quot;, 18, root_point=(0, 0), theme=self.CurrentTheme)
        fade_out_btn.set_on_click(self.trigger_fade_out)
        self.ui_elements.append(fade_out_btn)
        
        # Apply settings button
        apply_btn = Button(200, 560, 120, 30, &quot;Apply Settings&quot;, 20, root_point=(0, 0), theme=self.CurrentTheme)
        apply_btn.set_on_click(self.apply_settings)
        self.ui_elements.append(apply_btn)
        
        # Back to menu button
        back_btn = Button(50, 50, 120, 30, &quot;‚Üê Main Menu&quot;, 20, root_point=(0, 0), theme=self.CurrentTheme)
        back_btn.set_on_click(lambda: self.engine.set_scene(&quot;MainMenu&quot;))
        self.ui_elements.append(back_btn)
    
    def on_speed_changed(self, value):
        &quot;&quot;&quot;Handle speed slider change&quot;&quot;&quot;
        self.animation_speed = value
        self.speed_value_label.set_text(f&quot;{value:.1f}x&quot;)
    
    def on_zoom_changed(self, value):
        &quot;&quot;&quot;Handle zoom slider change&quot;&quot;&quot;
        self.animation_scale = value
        self.zoom_value_label.set_text(f&quot;{value:.1f}x&quot;)
    
    def on_fade_in_changed(self, value):
        &quot;&quot;&quot;Handle fade-in slider change&quot;&quot;&quot;
        self.fade_in_duration = value
        self.fade_in_value_label.set_text(f&quot;{value:.1f}s&quot;)
    
    def on_fade_out_changed(self, value):
        &quot;&quot;&quot;Handle fade-out slider change&quot;&quot;&quot;
        self.fade_out_duration = value
        self.fade_out_value_label.set_text(f&quot;{value:.1f}s&quot;)
    
    def on_auto_fade_changed(self, value):
        &quot;&quot;&quot;Handle auto-fade toggle change&quot;&quot;&quot;
        self.auto_fade_transitions = value
        print(f&quot;Auto fade transitions: {&#x27;ON&#x27; if value else &#x27;OFF&#x27;}&quot;)
    
    def apply_settings(self):
        &quot;&quot;&quot;Apply current speed, zoom and fade settings&quot;&quot;&quot;
        print(f&quot;Applying settings - Speed: {self.animation_speed}x, Zoom: {self.animation_scale}x, Fade-in: {self.fade_in_duration}s, Fade-out: {self.fade_out_duration}s&quot;)
        self.reload_animations_with_new_settings()
    
    def switch_animation(self):
        &quot;&quot;&quot;Switch between walk and idle animations with optional fade effects&quot;&quot;&quot;
        if self.current_animation and self.auto_fade_transitions:
            # Start fade out on current animation
            self.current_animation.start_fade_out(self.fade_out_duration)
            
            # Wait for fade out to complete before switching
            # In a real game, you&#x27;d use a callback or state machine
            # For this demo, we&#x27;ll switch immediately but the fade will continue
            pass
        
        # Switch animation
        if self.current_animation == self.walk_animation:
            self.current_animation = self.idle_animation
            self.current_animation_name = &quot;Idle&quot;
        else:
            self.current_animation = self.walk_animation
            self.current_animation_name = &quot;Walk&quot;
        
        if self.current_animation and self.auto_fade_transitions:
            # Start fade in on new animation
            self.current_animation.start_fade_in(self.fade_in_duration)
        
        self.current_animation.reset()
        self.current_animation.play()
        self.anim_name_label.set_text(f&quot;Current: {self.current_animation_name}&quot;)
        print(f&quot;Switched to {self.current_animation_name} animation&quot;)
    
    def trigger_fade_in(self):
        &quot;&quot;&quot;Trigger fade-in effect on current animation&quot;&quot;&quot;
        if self.current_animation:
            self.current_animation.start_fade_in(self.fade_in_duration)
            print(&quot;Triggered fade-in effect&quot;)
    
    def trigger_fade_out(self):
        &quot;&quot;&quot;Trigger fade-out effect on current animation&quot;&quot;&quot;
        if self.current_animation:
            self.current_animation.start_fade_out(self.fade_out_duration)
            print(&quot;Triggered fade-out effect&quot;)
    
    def play_animation(self):
        &quot;&quot;&quot;Play the current animation&quot;&quot;&quot;
        if self.current_animation:
            self.current_animation.play()
            print(&quot;Animation playing&quot;)
    
    def pause_animation(self):
        &quot;&quot;&quot;Pause the current animation&quot;&quot;&quot;
        if self.current_animation:
            self.current_animation.pause()
            print(&quot;Animation paused&quot;)
    
    def reset_animation(self):
        &quot;&quot;&quot;Reset the current animation&quot;&quot;&quot;
        if self.current_animation:
            self.current_animation.reset()
            print(&quot;Animation reset&quot;)
    
    def handle_key_press(self, key):
        &quot;&quot;&quot;Handle keyboard input&quot;&quot;&quot;
        if key == pygame.K_ESCAPE:
            self.engine.set_scene(&quot;MainMenu&quot;)
        elif key == pygame.K_SPACE:
            self.switch_animation()
        elif key == pygame.K_r:
            self.reset_animation()
        elif key == pygame.K_p:
            if self.current_animation and self.current_animation.playing:
                self.pause_animation()
            else:
                self.play_animation()
        elif key == pygame.K_a:
            # Apply settings with keyboard shortcut
            self.apply_settings()
        elif key == pygame.K_i:
            # Trigger fade-in with keyboard
            self.trigger_fade_in()
        elif key == pygame.K_o:
            # Trigger fade-out with keyboard
            self.trigger_fade_out()
        elif key == pygame.K_f:
            # Toggle auto-fade
            self.auto_fade_transitions = not self.auto_fade_transitions
            self.auto_fade_toggle.set_value(self.auto_fade_transitions)
            print(f&quot;Auto fade transitions: {&#x27;ON&#x27; if self.auto_fade_transitions else &#x27;OFF&#x27;}&quot;)
    
    def update(self, dt):
        &quot;&quot;&quot;Update scene logic&quot;&quot;&quot;
        # Update current animation
        if self.current_animation:
            self.current_animation.update()
            
            # Update frame counter
            frame_count = self.current_animation.get_frame_count()
            current_frame = self.current_animation.current_frame_index + 1
            self.frame_label.set_text(f&quot;Frame: {current_frame}/{frame_count}&quot;)
            
            # Update fade status display
            fade_status = &quot;&quot;
            if hasattr(self.current_animation, &#x27;fade_mode&#x27;) and self.current_animation.fade_mode:
                fade_status = f&quot; | Fade: {self.current_animation.fade_mode.upper()} ({self.current_animation.fade_alpha}/255)&quot;
            self.frame_label.set_text(f&quot;Frame: {current_frame}/{frame_count}{fade_status}&quot;)
    
    def render(self, renderer):
        &quot;&quot;&quot;Render the scene&quot;&quot;&quot;
        # Draw background
        current_theme = ThemeManager.get_theme(ThemeManager.get_current_theme())
        renderer.draw_rect(0, 0, 1024, 720, current_theme.background)
        
        # Draw current animation centered
        if self.current_animation:
            frame = self.current_animation.get_current_frame()
            if frame:
                x = 700 - frame.get_width() // 2
                y = 400 - frame.get_height() // 2
                
                # Draw bounding box
                renderer.draw_rect(x, y, frame.get_width(), frame.get_height(), (255, 255, 255), fill=False)
                
                # Draw the frame (with fade effect already applied)
                renderer.draw_surface(frame, x, y)
                
                # Draw animation info below the sprite
                fade_info = &quot;&quot;
                if hasattr(self.current_animation, &#x27;fade_alpha&#x27;) and self.current_animation.fade_alpha &lt; 255:
                    fade_info = f&quot; | Alpha: {self.current_animation.fade_alpha}/255&quot;
                
                info_text = f&quot;{self.current_animation_name} - {self.animation_speed:.1f}x speed - {self.animation_scale:.1f}x zoom{fade_info}&quot;
                font = pygame.font.Font(None, 24)
                text_surface = font.render(info_text, True, (255, 255, 255))
                renderer.draw_surface(text_surface, x, y + frame.get_height() + 10)
        
        # Draw UI elements
        for element in self.ui_elements:
            element.render(renderer)


class MainMenuScene(Scene):
    &quot;&quot;&quot;
    Simple main menu for the sprite sheet test.
    &quot;&quot;&quot;
    
    def __init__(self, engine: LunaEngine):
        super().__init__(engine)
        self.CurrentTheme = ThemeType.DEFAULT
        
        # Title
        title = TextLabel(512, 150, &quot;Sprite Sheet Test&quot;, 72, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(title)
        
        subtitle = TextLabel(512, 220, &quot;LunaEngine Animation System&quot;, 36, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(subtitle)
        
        subtitle2 = TextLabel(512, 260, &quot;Now with Fade Effects!&quot;, 28, root_point=(0.5, 0), theme=self.CurrentTheme)
        self.ui_elements.append(subtitle2)
        
        # Demo button
        spritesheet_btn = Button(512, 320, 250, 40, &quot;Start Test&quot;, 28, root_point=(0.5, 0), theme=self.CurrentTheme)
        spritesheet_btn.set_on_click(lambda: engine.set_scene(&quot;SpriteSheetTest&quot;))
        self.ui_elements.append(spritesheet_btn)
        
        exit_btn = Button(512, 380, 250, 40, &quot;Exit&quot;, 28, root_point=(0.5, 0), theme=self.CurrentTheme)
        exit_btn.set_on_click(lambda: setattr(engine, &#x27;running&#x27;, False))
        self.ui_elements.append(exit_btn)
    
    def on_enter(self, previous_scene=None):
        super().on_enter(previous_scene)
        print(&quot;Entered Main Menu&quot;)
    
    def on_exit(self, next_scene=None):
        super().on_exit(next_scene)
        print(&quot;Exiting Main Menu&quot;)
    
    def update(self, dt):
        pass
    
    def render(self, renderer):
        # Draw background
        current_theme = ThemeManager.get_theme(ThemeManager.get_current_theme())
        renderer.draw_rect(0, 0, 1024, 720, current_theme.background)
        
        # Draw UI
        for element in self.ui_elements:
            element.render(renderer)


def main():
    &quot;&quot;&quot;Main entry point for the sprite sheet test&quot;&quot;&quot;
    engine = LunaEngine(&quot;LunaEngine - Sprite Sheet Test with Fade Effects&quot;, 1024, 720)
    engine.fps = 60
    
    # Add scenes
    engine.add_scene(&quot;MainMenu&quot;, MainMenuScene)
    engine.add_scene(&quot;SpriteSheetTest&quot;, SpriteSheetTestScene)
    
    # Start with main menu
    engine.set_scene(&quot;MainMenu&quot;)
    engine.run()


if __name__ == &quot;__main__&quot;:
    main()</code></pre>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card shadow-sm sticky-top" style="top: 20px;">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>About This Example</h5>
                    </div>
                    <div class="card-body">
                        <p>Sprite Sheets Example - Testing SpriteSheet and Animation System with LunaEngine</p>
                        <hr>
                        <div class="d-grid gap-2">
                            <a href="spritesheets.py" download class="btn btn-outline-primary">
                                <i class="bi bi-download me-2"></i>Download Python File
                            </a>
                            <a href="index.html" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-left me-2"></i>Back to Examples Hub
                            </a>
                            <a href="../quick-start.html" class="btn btn-outline-success">
                                <i class="bi bi-play-circle me-2"></i>Quick Start Guide
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer-section">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="bi bi-moon-stars-fill me-2"></i>LunaEngine</h5>
                    <p class="text-white-50">2D Game Framework for Python</p>
                </div>
                <div class="col-md-6 text-end">
                    <p class="text-white-50">
                        <i class="bi bi-lightning-charge me-1"></i>
                        Documentation generated on 2026-02-03 16:03
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="theme.js"></script>
    
    <script>
    // Universal search handler
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('moduleSearch');
        const searchIcon = document.querySelector('.input-group-text');
        
        if (searchInput && searchIcon) {
            const performSearch = () => {
                const searchTerm = searchInput.value.trim();
                if (searchTerm) {
                    const currentPath = window.location.pathname;
                    let searchPath = 'search.html';
                    
                    // Adjust path based on current location
                    if (currentPath.split('/').filter(Boolean).length > 2) {
                        searchPath = '../search.html';
                    }
                    
                    window.location.href = `${searchPath}?q=${encodeURIComponent(searchTerm)}`;
                }
            };
            
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault(); 
                    e.stopPropagation();
                    performSearch();
                    return false;
                }
            });
            
            searchIcon.addEventListener('click', performSearch);
            
            const form = searchInput.closest('form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    performSearch();
                    return false;
                });
            }
        }
    });
    </script>
    
    
</body>
</html>